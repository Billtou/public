substitutions:
  SCREEN_MAIN: main
  SCREEN_ROOMS: rooms
  SCREEN_KITCHEN: kitchen
  SCREEN_FAVORITE: favorite
  
esphome:
  name: "dashboard-one-3d68"
  friendly_name: "dashboard-one-3d68"
  platformio_options:
    board_upload.maximum_ram_size: 327680
    board_upload.maximum_size: 16777216
    board_build.partitions: "/config/esphome/custom_partitions_3584.csv" #"/config/esphome/custom_partitions_8128.csv"  #
    board_build.arduino.memory_type: qio_opi  
    
esp32:
  board: esp32-s3-devkitc-1
  framework:
    type: arduino
  flash_size: 16MB    


logger:

api:

ota:

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

external_components:
  - source:
      type: git
      url: https://github.com/strange-v/ha_deck
      ref: main
    components: [ hd_device_wt32s3_86s, ha_deck ]

web_server:
  port: 80


time:
  - platform: sntp  #定義時間參數
    id: sntp_time
    timezone: Asia/Taipei
    on_time:
      - cron: '* * * * * *'
        then:
          lambda: |-
            char buff[10] = "-";
            auto time = id(sntp_time).now();
            if (time.is_valid())
              sprintf(buff, "%02d:%02d:%02d", time.hour, time.minute, time.second);
            id(local_time).set_value(std::string(buff));

number:
  - platform: template   # 定義活躍的entity螢幕亮度參數
    id: screen_brightness
    name: Active screen brightness
    min_value: 0
    max_value: 100
    step: 5
    initial_value: 75
    restore_value: true
    set_action:
      - lambda: |-
          if (!id(deck).get_inactivity())
            id(device).set_brightness(x);

  - platform: template ## 定義不活躍的entity螢幕亮度參數(失聯或斷網)
    id: inactive_screen_brightness
    name: Inactive screen brightness
    min_value: 0
    max_value: 100
    step: 5
    initial_value: 20
    restore_value: true
    set_action:
      - lambda: |-
          if (id(deck).get_inactivity())
            id(device).set_brightness(x);

output:
  - platform: ledc  
    pin: 10
    id: out_10

light:  
  - platform: monochromatic
    id: dummy_light
    name: Dummy
    output: out_10
    
hd_device_wt32s3_86s:
  id: device
  brightness: 75

ha_deck:
  id: deck
  main_screen: ${SCREEN_MAIN}  # 設備參數
  inactivity:
    period: 60 # seconds 60秒回主畫面
    blank_screen: true  #休眠黑畫面有效(建置期可以 ctrl + / 標註起來)
  on_inactivity_change:
    lambda:  |-
      if (x) {
        id(device).set_brightness(id(inactive_screen_brightness).state);
      } else {
        id(device).set_brightness(id(screen_brightness).state);
      }
  screens:
    ##########################################
    #
    #     主畫面 
    #
    #########################################
    - name: ${SCREEN_MAIN} 
      widgets:  
